
Assignment 2 :- 

/* Display the list of products (Id, Title, Count of Categories) which fall in more than one Categories.
*/
1.	SELECT product.productId , productName , COUNT(categoryId.categoryId) 
		countOfCategory from product 

		INNER JOIN categoryId ON product.productId = categoryId.productId 
		GROUP BY categoryId.productId Having Count(categoryId.productId) > 1 ;



/*Display Count of products as per below price range:
*/
2.	SELECT price, count(*) no_of_products
FROM 
		(SELECT CASE
 
			WHEN price >= 0 AND price <= 1000 THEN '0-1000'
                
			WHEN price >= 10001 AND price <= 50000 THEN '1001-5000'
                
			ELSE 'Above 5000'
            
			END as price
      
			FROM product) 
		as count_of_products

		GROUP BY price;



/*Display the Categories along with number of products under each category.
*/
3.	SELECT categoryName, category.categoryId, COUNT(productId) 
	no_of_products 
FROM 
	category INNER JOIN categoryid ON
	
	category.categoryId = categoryid.categoryId

	GROUP BY category.categoryId;



Assignment 3 :- 

/*Display Shopper’s information along with number of orders he/she placed during last 30 days.
*/

1.	SELECT 
name As name , 
email As email , 
phone as Phone , 
count(orders.shopperId) As count 

	from user RIGHT JOIN orders 
ON user.userID = orders.shopperId 

	where orders.OrderDate > DATE_SUB(NOW(), INTERVAL 30 DAY)

	GROUP BY (orders.shopperId);


/*Display the top 10 Shoppers who generated maximum number of revenue in last 30 days.
*/
2.	
SELECT 
name As name,
email As email ,
phone As Phone ,
sum(orders.orderTotal) 

	from user RIGHT JOIN orders 
ON user.userID = orders.shopperId 

	where orders.OrderDate > DATE_SUB(NOW(), INTERVAL 30 DAY)
GROUP BY (orders.shopperId) DESC LIMIT 10;


/*Display top 20 Products which are ordered most in last 60 days along with numbers.
*/
3.	
SELECT 
product.productname As name ,
sum(quantity)
from orderedProducts 
	LEFT JOIN product on orderedProducts.productId = product.productId 

	LEFT JOIN orders on orderedProducts.orderId = orders.orderId 

	where orders.OrderDate > DATE_SUB(NOW(), INTERVAL 60 DAY)

	GROUP BY (orderedProducts.productId) DESC LIMIT 20;


/*Display Monthly sales revenue of the StoreFront for last 6 months. It should display each month’s sale.
*/

4.	
SELECT DATE_FORMAT(orders.orderDate, "%m-%Y") 
	AS Month,orders.orderTotal as MonthlySales

	FROM orderedProducts left join orders on orderedProducts.orderId = orders.orderId 

	left join orderstatus on
orderedproducts.orderId = orderStatus.orderId

	where orderstatus.status='Shipped' and orders.OrderDate > DATE_SUB(NOW(), INTERVAL 6 Month)

	GROUP BY DATE_FORMAT(orders.orderdate, "%m-%Y") desc LIMIT 6;


/*Mark the products as Inactive which are not ordered in last 90 days.
*/
5.	
SELECT product.productName 
	from 
product left join orderstatus on product.productId = orderstatus.productId 

	left join orders on orderstatus.orderid = orders.orderId

	where orderdate = null || orderdate < DATE_SUB(NOW(), 
	INTERVAL 90 DAY)
GROUP BY (product.productId);


/*Given a category search keyword, display all the Products present in this category/categories. 
*/

6.	SELECT product.ProductId, product.ProductName 
	from product inner join categoryid on product.ProductId = categoryid.ProductId  
	inner join category on categoryid.CategoryId = category.CategoryId 
	where category.CategoryName like "x%";

/*Display top 10 Items which were cancelled most.
*/
7.	SELECT product.productName , count(orderstatus.status) 
	from
 product RIGHT JOIN orderstatus on 
	product.productId = orderstatus.productId 

	where status = 'Cancelled'
GROUP BY (ORDERID)
DESC Limit 10;











Assignment 4 :- 

/*
Create appropriate tables and relationships for the same and write a SQL
         query for that returns a Resultset containing Zip Code, City Names and
         States ordered by State Name and City Name.
*/

1.	CREATE TABLE state (
 
	StateId int(11) AUTO_INCREMENT,
 
	StateName varchar(45) UNIQUE NOT NULL,
 
	PRIMARY KEY (StateId)
); 



	CREATE TABLE city (
 
	CityId int(11) AUTO_INCREMENT,
 
	CityName varchar(45) NOT NULL,
 
	ZipCode int(11) NOT NULL,
 
	StateId int(11) NOT NULL,
 
	PRIMARY KEY (CityId),
 
	KEY StateId (StateId),
 
	FOREIGN KEY (StateId) REFERENCES state (StateId)
) ;



	INSERT INTO state (StateName) 
	
	VALUES ('Rajasthan');


	
INSERT INTO state (StateName) 
	
	VALUES ('Goa');


	
INSERT INTO state (StateName) 
	
	VALUES ('Gujrat');


	
INSERT INTO state (StateName) 
	
	VALUES ('Uttarakhand');



	INSERT INTO state (StateName) 
	
	VALUES ('Laddakh');



	INSERT INTO city (cityName,zipcode,stateId) 
	
	VALUES ('Jaipur',302033,1);


	
INSERT INTO city (cityName,zipcode,stateId) 
	
	VALUES ('dfhhgd',302093,2);



	INSERT INTO city (cityName,zipcode,stateId) 
	
	VALUES ('kuljhgf',262033,3);


	
INSERT INTO city (cityName,zipcode,stateId) 
	
	VALUES ('asg',985464,4);



	INSERT INTO city (cityName,zipcode,stateId) 
	
	VALUES ('rgykj',226017,5);


	1. SELECT city.ZipCode AS "Zip Code", city.CityName AS "City Name" , state.StateName AS "State Name" 
	FROM city LEFT JOIN state ON city.StateId = state.StateId 
	ORDER BY state.StateName,city.CityName;


Assignment 5 :-

/*
Create a view displaying the order information (Id, Title, Price, Shopper’s name, Email, Orderdate, Status) with latest ordered items should be displayed first for last 60 days.
*/

1. 	CREATE VIEW OrderInformation 
	AS SELECT orderedproducts.OrderId AS "OrderId",product.ProductName AS "Title", product.Price AS "Price", 
	user.Name AS "ShopperName",user.Email AS "Email", orders.OrderDate AS "OrderDate", orderstatus.Status AS "Status" 
	from orderedproducts INNER JOIN product ON orderedproducts.ProductId = product.ProductId 
	INNER JOIN orderstatus ON orderedproducts.OrderId = orderstatus.OrderId 
	AND orderedproducts.ProductId = orderstatus.ProductId INNER JOIN orders ON orderedproducts.OrderId = orders.OrderId 
	INNER JOIN user ON orders.ShopperId = user.UserId  WHERE orders.OrderDate > Date_sub(NOW(), INTERVAL 60 DAY);

/*
Use the above view to display the Products(Items) which are in ‘shipped’ state.
*/

2. 	SELECT OrderInformation.OrderId, OrderInformation.Title,OrderInformation.ShopperName,OrderInformation.Email,OrderInformation.OrderDate,OrderInformation.Status 
	FROM OrderInformation WHERE OrderInformation.Status = "Shipped"; 

/*
Use the above view to display the top 5 most selling products.
*/

3. 	SELECT OrderInformation.Title, count(Title) AS "TotalSell" 
	FROM OrderInformation GROUP BY OrderInformation.Title 
	ORDER BY TotalSell DESC LIMIT 5;

